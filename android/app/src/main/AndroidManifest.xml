<manifest xmlns:android="http://schemas.android.com/apk/res/android">
    <!-- Android 14+ foreground service type permissions -->
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE_DATA_SYNC" />

    <!-- Required Permissions -->
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.READ_SMS" />
    <uses-permission android:name="android.permission.RECEIVE_SMS" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
    <!-- Needed to detect incoming call state for soft-blocking -->
    <uses-permission android:name="android.permission.READ_PHONE_STATE" />
    <!-- Improves access to incoming numbers on newer Android versions -->
    <uses-permission android:name="android.permission.READ_CALL_LOG" />
    <uses-permission android:name="android.permission.READ_PHONE_NUMBERS" />

    <uses-permission android:name="android.permission.DETECT_SCREEN_CAPTURE" />
    <uses-permission android:name="android.permission.DETECT_SCREEN_RECORDING" />

    <!-- Package visibility for stores used by Talsec alternative store detection -->
    <queries>
        <package android:name="com.android.vending" />
        <!-- Uncomment if you add Samsung store to supportedAlternativeStores in code -->
        <!-- <package android:name="com.sec.android.app.samsungapps" /> -->
    </queries>

    <application
        android:label="malwirus"
        android:name="com.zrelxr06.malwirus.device_security.TalsecApplication"
        android:icon="@mipmap/ic_launcher"
        android:enableOnBackInvokedCallback="true">
        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:launchMode="singleTask"
            android:alwaysRetainTaskState="true"
            android:theme="@style/LaunchTheme"
            android:configChanges="orientation|keyboardHidden|keyboard|screenSize|smallestScreenSize|locale|layoutDirection|fontScale|screenLayout|density|uiMode"
            android:hardwareAccelerated="true"
            android:windowSoftInputMode="adjustResize">
            <!-- Specifies an Android theme to apply to this Activity as soon as
                 the Android process has started. This theme is visible to the user
                 while the Flutter UI initializes. After that, this theme continues
                 to determine the Window background behind the Flutter UI. -->
            <meta-data
                android:name="io.flutter.embedding.android.NormalTheme"
                android:resource="@style/NormalTheme" />
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <!-- Don't delete the meta-data below.
             This is used by the Flutter tool to generate GeneratedPluginRegistrant.java -->
        <meta-data
            android:name="flutterEmbedding"
            android:value="2" />

        <!-- SMS Receiver -->
        <receiver
            android:name="com.zrelxr06.malwirus.sms_security.receiver.SmsReceiver"
            android:enabled="false"
            android:exported="true"
            android:permission="android.permission.BROADCAST_SMS">
            <intent-filter>
                <action android:name="android.provider.Telephony.SMS_RECEIVED" />
            </intent-filter>
        </receiver>
        <!-- Call Receiver for soft-block notifications -->
        <receiver
            android:name="com.zrelxr06.malwirus.sms_security.receiver.CallReceiver"
            android:enabled="true"
            android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.PHONE_STATE" />
            </intent-filter>
        </receiver>
        <!--  Notification Action Receiver  -->
        <receiver
            android:name="com.zrelxr06.malwirus.notification.action.NotificationActionHandler"
            android:enabled="true"
            android:exported="false">
            <intent-filter>
                <action android:name="com.zrelxr06.malwirus.ACTION_WHITELIST_NUMBER" />
                <action android:name="com.zrelxr06.malwirus.ACTION_IGNORE_MESSAGE" />
            </intent-filter>
        </receiver>

        <!-- Web Security VPN Service -->
        <service
            android:name="com.zrelxr06.malwirus.web_security.service.WebSecurityVpnService"
            android:enabled="true"
            android:exported="false"
            android:permission="android.permission.BIND_VPN_SERVICE"
            android:foregroundServiceType="dataSync">
            <intent-filter>
                <action android:name="android.net.VpnService" />
            </intent-filter>
        </service>

        <!-- Monitoring foreground service for persistent notification UI -->
        <service
            android:name="com.zrelxr06.malwirus.notification.MonitoringService"
            android:enabled="true"
            android:exported="false"
            android:foregroundServiceType="dataSync" />

        <!-- Rules update receiver to apply live changes -->
        <receiver
            android:name="com.zrelxr06.malwirus.web_security.receiver.RulesUpdateReceiver"
            android:enabled="true"
            android:exported="false">
            <intent-filter>
                <action android:name="com.zrelxr06.malwirus.web.ACTION_RULES_CHANGED" />
                <action android:name="com.zrelxr06.malwirus.web.ACTION_DNS_CHANGED" />
            </intent-filter>
        </receiver>


    </application>
    <!-- Required to query activities that can process text, see:
         https://developer.android.com/training/package-visibility and
         https://developer.android.com/reference/android/content/Intent#ACTION_PROCESS_TEXT.

         In particular, this is used by the Flutter engine in io.flutter.plugin.text.ProcessTextPlugin. -->
    <queries>
        <intent>
            <action android:name="android.intent.action.PROCESS_TEXT" />
            <data android:mimeType="text/plain" />
        </intent>
    </queries>
</manifest>
